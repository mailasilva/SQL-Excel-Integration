--MODULO 27: INTEGRAÃ‡AO SQL E EXCEL 

--VIEW VENDAS_INTERNET PARA ANO 2013: 52.801 ROWS

USE AdventureWorksDW2014

SELECT * FROM FactInternetSales WHERE YEAR(OrderDate) = 2013

GO
ALTER VIEW VENDAS_INTERNET AS 
SELECT 
    SalesOrderNumber AS 'ORDER NUMBER',
    OrderDate AS 'ORDER DATE',
    EnglishProductCategoryName 'CATEGORY',
    FIRSTNAME + ' ' + LASTNAME AS 'CUSTOMER NAME',
    GENDER AS 'GENDER',
    SALESTERRITORYCOUNTRY AS 'COUNTRY',
    OrderQuantity AS 'ORDER QTY',
    TotalProductCost AS 'PRODUCT COST',
    SALESAMOUNT AS 'SALES AMOUNT'
FROM 
    FactInternetSales
        INNER JOIN DimCustomer
            ON FactInternetSales.CustomerKey = DimCustomer.CustomerKey
                INNER JOIN DimSalesTerritory
                    ON FACTINTERNETSALES.SalesTerritoryKey = DimSalesTerritory.SalesTerritoryKey
INNER JOIN DimProduct
    ON FactInternetSales.ProductKey = DimProduct.ProductKey
        INNER JOIN DimProductSubcategory 
            ON DimProduct.ProductSubcategoryKey = DimProductSubcategory.ProductSubcategoryKey 
                INNER JOIN DimProductCategory 
                    ON DimProductSubcategory.ProductCategoryKey = DimProductCategory.ProductCategoryKey
WHERE YEAR(OrderDate) = 2013 
GO